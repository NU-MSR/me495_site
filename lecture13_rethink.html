<!-- Generated with pandoc -D html
Modified by Matthew Elwin.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<meta name="author" content="Matthew Elwin" />
<title>Introduction to Baxter and Sawyer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
</style>
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
<![endif]-->
<style type="text/css">
/*
Matthew Elwin
css for the nume template for making websites

Contains code modified from with https://gist.github.com/killercup/5917178
Mostly using the aesthetics from above, but added a table of contents menu to the left.
When printing, the menu will be hidden

*/


nav#TOC{
    width: 20%;
    height: 100%;
    position:fixed!important;
    z-index:1;
    overflow:auto;
    padding-right: 2em;
}

.home_up{
    position: fixed;
    right: 0.25em;
    top: 0.25em;
}
.content{
    margin-left: 21%;
    padding-left: 4em;
}

.inner{
    margin: 0 auto;
    min-width: 30em;
    max-width: 50em;
}

.no-foot{
    min-height: 100vh 
}

.container:after,.container:before{content:"";display:table;clear:both}

.footer {
    font-size: 9pt
}

html {
  font-size: 100%;
  overflow-y: scroll;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  padding: 0;
}

body {
  font-family: "DejaVu Serif", Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
  font-size: 12px;
  line-height: 1.7;
  padding: 1em;
  background: #fefefe;
}

a {
  color: #0645ad;
  text-decoration: none;
}

a:visited {
  color: #0b0080;
}

nav a:visited {
    color: #0645ad;
}

a:hover {
  color: #06e;
}

nav a:hover {
    color: #0645ad;
    background: #C3C3DE
}

a:active {
  color: #faa700;
}

a:focus {
  outline: thin dotted;
}

*::-moz-selection {
  background: rgba(255, 255, 0, 0.3);
  color: #000;
}

*::selection {
  background: rgba(255, 255, 0, 0.3);
  color: #000;
}

a::-moz-selection {
  background: rgba(255, 255, 0, 0.3);
  color: #0645ad;
}

a::selection {
  background: rgba(255, 255, 0, 0.3);
  color: #0645ad;
}

p {
  margin: 1em 0;
}

img {
  max-width: 100%;
}

h1, h2, h3, h4, h5, h6 {
  color: #111;
  line-height: 125%;
  margin-top: 1em;
  font-weight: normal;
}

h4, h5, h6 {
  font-weight: bold;
}

h1 {
  font-size: 2.5em;
}

h1.title {
    margin-top: 0em;
    font-size: 3em;
}

h2 {
  font-size: 2em;
}

h3 {
  font-size: 1.5em;
}

h4 {
  font-size: 1.2em;
}

h5 {
  font-size: 1em;
}

h6 {
  font-size: 0.9em;
}

blockquote {
  color: #666666;
  margin: 0;
  padding-left: 3em;
  border-left: 0.5em #EEE solid;
}

hr {
  display: block;
  height: 2px;
  border: 0;
  border-top: 1px solid #aaa;
  border-bottom: 1px solid #eee;
  margin: 1em 0;
  padding: 0;
}

pre, code, kbd, samp {
    color: #000;
    background-color: #f0f0f0;
  border: 1px solid #e1e4e5;
  font-family: monospace, monospace;
  _font-family: 'courier new', monospace;
  font-size: 0.98em;
}

.line-block {
    color: #000;
    background-color: #f0f0f0;
    border: 1px solid #e1e4e5;
}
/* this style is used for inline code blocks 
it is overwridden when inside a pre format block*/
code {
    padding: 0 5px;
    white-space: nowrap;
    font-size: 85%
}

pre {
  white-space: pre;
  white-space: pre-wrap;
  word-wrap: break-word;
}

pre code {
    padding: 0 0;
    white-space: inherit;
    border: 0
}

b, strong {
  font-weight: bold;
}

dfn {
  font-style: italic;
}

ins {
  background: #ff9;
  color: #000;
  text-decoration: none;
}

mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

sub, sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sup {
  top: -0.5em;
}

sub {
  bottom: -0.25em;
}

ul, ol {
  margin: 1em 0;
  padding: 0 0 0 2em;
}

li > ul, li > ol {
    margin: 0 0;
}

nav ul, nav ol {
    list-style: none;
    padding: 0 0 0 0;
}

/* make the top level list item in table of contents not indent*/
nav li > ul, nav li > ol {
    list-style: none;
    padding: 0 0 0 2em;
}

li p:last-child {
  margin-bottom: 0;
}

ul ul, ol ol {
  margin: .3em 0;
}

dl {
  margin-bottom: 1em;
}

dt {
  font-weight: bold;
  margin-bottom: .8em;
}

dd {
  margin: 0 0 .8em 2em;
}

dd:last-child {
  margin-bottom: 0;
}

img {
  border: 0;
  -ms-interpolation-mode: bicubic;
  vertical-align: middle;
}

figure {
  display: block;
  text-align: center;
  margin: 1em 0;
}

figure img {
  border: none;
  margin: 0 auto;
}

figcaption {
  font-size: 0.8em;
  font-style: italic;
  margin: 0 0 .8em;
}

table {
  margin-bottom: 2em;
  border-bottom: 1px solid #ddd;
  border-right: 1px solid #ddd;
  border-spacing: 0;
  border-collapse: collapse;
}

table th {
  padding: .2em 1em;
  background-color: #eee;
  border-top: 1px solid #ddd;
  border-left: 1px solid #ddd;
}

table td {
  padding: .2em 1em;
  border-top: 1px solid #ddd;
  border-left: 1px solid #ddd;
  vertical-align: top;
}

.author {
  font-size: 1.2em;
}

/* When the screen gets too narrow, hide the toc*/
@media only screen and (max-width: 768px) {
    nav {
        visibility: hidden
    }
    .content {
        margin-left: 0;
    }
}

@media only screen and (min-width: 480px) {
  body {
      font-size: 14px;
  }
}
@media only screen and (min-width: 768px) {
  body {
    font-size: 16px;
  }
}
@media print {
  * {
    background: transparent !important;
    color: black !important;
    filter: none !important;
    -ms-filter: none !important;
  }

  nav {
      visibility: hidden;
  }

  .content{
      margin-left: 0%;
      padding-left: 10px;
  }

  body {
    font-size: 10pt;
    max-width: 100%;
  }

  a, a:visited {
    text-decoration: underline;
  }

  hr {
    height: 1px;
    border: 0;
    border-bottom: 1px solid black;
  }

  a[href]:after {
    content: " (" attr(href) ")";
  }

  abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
    content: "";
  }

  pre, blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  tr, img {
    page-break-inside: avoid;
  }

  img {
    max-width: 100% !important;
  }

  @page :left {
    margin: 15mm 20mm 15mm 10mm;
}

  @page :right {
    margin: 15mm 10mm 15mm 20mm;
}

  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }

  h2, h3 {
    page-break-after: avoid;
  }
}


</style>
</head>
<body>

<!-- Sidebar for table of contents -->
<nav id="TOC" role="doc-toc">
<h3>Table of Contents</h3>
<ul>
<li><a href="#overview">Overview</a><ul>
<li><a href="#robot-features">Robot Features</a></li>
</ul></li>
<li><a href="#setup">Setup</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#network">Network</a></li>
<li><a href="#testing-your-setup">Testing Your Setup</a></li>
</ul></li>
<li><a href="#using-the-robots">Using the Robots</a></li>
<li><a href="#programming-the-robots">Programming the Robots</a><ul>
<li><a href="#urdf-for-baxter-and-sawyer">URDF for Baxter and Sawyer</a></li>
</ul></li>
<li><a href="#simulators">Simulators</a></li>
<li><a href="#series-elastic-actuators">Series Elastic Actuators</a><ul>
<li><a href="#thought-experiments">Thought Experiments</a></li>
</ul></li>
</ul>
</nav>

<nav class="home_up">
  <a href="index.html">Home</a>
</nav>
<div class="content">
  <div class="inner">
    <div class="no-foot">
<!-- Put the header to the right of the table of contents -->
<header id="title-block-header">
<h1 class="title">Introduction to Baxter and Sawyer</h1>
</header>

<!-- The main content of the file -->
<h1 id="overview">Overview</h1>
<p>The Baxter and Sawyer robots from <a href="http://rethinkrobotics.com">Rethink Robotics</a> are manufacturing robots designed to operate around people. Both robots use series elastic actuators (SEAs) in all their joints, meaning that there is an elastic element (e.g., a spring) between the gearbox and the joint. These actuators add mechanical compliance, enabling easier force control at the expense of position control bandwidth.</p>
<h2 id="robot-features">Robot Features</h2>
<ul>
<li><a href="https://sdk.rethinkrobotics.com/wiki/Hardware_Specifications">Baxter Hardware Specifications</a></li>
<li><a href="https://sdk.rethinkrobotics.com/intera/Hardware_Components">Sawyer Hardware Specifications</a></li>
</ul>
<h3 id="summary">Summary</h3>
<ul>
<li>Arms
<ul>
<li>Baxter: Two arms, each with seven degrees of freedom (DOF)</li>
<li>Sawyer: One arm with seven degrees of freedom</li>
<li>Series elastic actuators at each joint</li>
<li>Accurate joint torque measurements (when calibrated)</li>
</ul></li>
<li>Head
<ul>
<li>Pan/tilt ability</li>
<li>Built in camera</li>
<li>Display</li>
</ul></li>
<li>Control
<ul>
<li>On-board computer running Gentoo Linux and ROS Kinetic</li>
<li>Can run ROS nodes remotely or on-board</li>
<li>Low-level controllers prevent self-collisions and enforce limits on acceleration, torque, and position.</li>
<li>Buttons on arm and grippers.</li>
<li>Zero-g mode: when enabled you can grab the cuff of an arm and move it anywhere</li>
</ul></li>
<li>Distance sensors
<ul>
<li>Infrared distance sensor in the hand</li>
<li>Baxter: Sonar ring around head</li>
</ul></li>
<li>Cameras
<ul>
<li>One camera per hand</li>
<li>One camera in the head</li>
<li>Baxter has three cameras, but you can only stream from two simultaneously</li>
</ul></li>
<li>Grippers
<ul>
<li>Interchangeable grippers and jaws</li>
<li>We use electric grippers, but vacuum grippers are also available</li>
<li>Custom grippers are possible as well</li>
</ul></li>
</ul>
<h1 id="setup">Setup</h1>
<ul>
<li>Baxter and Sawyer run <code>rosmaster</code> on their onboard computers.</li>
<li>You run nodes on your computer that communicate with the remote <code>rosmaster</code></li>
<li>It is also possible to have nodes run on Baxter or Sawyer
<ul>
<li>However, we do not have root access to these robots and can't install packages</li>
<li>For most of our purposes, running our custom nodes on our own computers is fine.</li>
</ul></li>
</ul>
<h2 id="installation">Installation</h2>
<ul>
<li>The Baxter and Sawyer software is not released for <code>melodic</code></li>
<li>Some code, especially for <code>baxter</code> has to be patched to work.</li>
<li>Create a new workspace and use this <a href="./rethink.rosinstall">rosinstall</a> file to download the code for baxter and sawyer
<ul>
<li>Some code comes from forked repositories, with fixes to make it compile on Ubuntu 18.04 with <code>melodic</code></li>
</ul></li>
<li>Build the workspace. I recommend sourcing the <code>devel/setup.bash</code> from your <code>.bashrc</code> so you will always have the packages accessible.</li>
<li>You also need some dependencies. Install
<ul>
<li><code>ros-melodic-effort_controllers</code></li>
<li><code>ros-melodic-effort-controllers</code></li>
</ul></li>
</ul>
<p>Instructions:</p>
<pre><code>mkdir rethink_ws/src
cd rethink_ws/src
wstool init
wstool merge rethink.rosinstall
wstool update
cd ..
catkin_make
</code></pre>
<h2 id="network">Network</h2>
<ul>
<li>Copy <a href="./Rethink">this file</a> to <code>/etc/NetworkManager/system-connections/</code> and restart NetworkManager (<code>systemctl restart NetworkManager</code>)</li>
<li>Select this profile when connecting to Baxter or Sawyer. Or via the command-line do <code>nmcli connection up Rethink</code></li>
<li>When connected to Baxter or Sawyer, your ip address is <code>10.42.0.1</code> and the robot's ip addres is <code>10.42.0.2</code></li>
<li>To have nodes on your computer connect to the remote <code>rosmaster</code>:
<ul>
<li><p>The <code>ROS_MASTER_URI</code> environment variable must be set to the robot's rosmaster uri: <code>http://10.42.0.2:113111</code></p>
<ul>
<li>This variable tells ROS nodes how to connect to <code>rosmaster</code></li>
</ul></li>
<li><p>The <code>ROS_IP</code> environment variable should be the ip address of your computer (<code>10.42.0.1</code>).</p>
<ul>
<li>This variable tells <code>rosmaster</code> how to connect to your computer</li>
</ul></li>
<li><p>Feel free to write a <code>bash</code> script that you can source to set these environment variables appropriately</p>
<pre><code>export ROS_MASTER_URI=http://10.42.0.2:11311
export ROS_IP=10.42.0.1
</code></pre></li>
<li><p>If you read Rethink's instructions, they provide a script that sets these variables for you. I don't like everything it does so I just use my own script.</p></li>
</ul></li>
</ul>
<h2 id="testing-your-setup">Testing Your Setup</h2>
<ol>
<li>Make sure you can ping 10.42.0.2.</li>
<li>When you run <code>rqt_graph</code> you should see all the ROS nodes that are running on baxter/sawyer</li>
<li>You may be able to ping <code>sawyer.local</code> or <code>baxter.local</code>, but this name resolution need not work for you to be able to connect.</li>
</ol>
<h1 id="using-the-robots">Using the Robots</h1>
<ol>
<li>Whenever you are using the robots, be ready to press the E-Stop to prevent the robot from crashing into anything.</li>
<li>Each robot has a power button. Press it once to turn on, once to turn off; never hold the power button.</li>
<li>Each robot takes a very long time to boot up so be patient. You should leave the robots on most of the time, but if the robot is being left unattended it MUST be disabled.
<ul>
<li>For Baxter: <code>rosrun baxter_tools enable_robot.py -d</code> disables the robot.</li>
<li>For Sawyer: <code>rosrun intera_interface enable_robot.py -d</code> disables the robot.</li>
</ul></li>
<li>If you wish to move the robot arms manually, you should enable them and use zero-g mode:
<ul>
<li>For Baxter: <code>rosrun baxter_tools enable_robot.py -e</code> enables the robot, then squeezing the cuff starts zero-g mode.</li>
<li>For Sawyer: <code>rosrun intera_interface enable_robot.py -e</code> enables the robot. Squeezing the cuff or pressing the O button starts zero-g mode.</li>
<li>In zero-g mode the arm should be easy to move and you should not here any winding or feel resistance.</li>
</ul></li>
<li>If the E-stop is pressed, you need to release the e-stop by twisting and reset the robot
<ul>
<li>For Baxter: <code>rosrun baxter_tools enable_robot.py -r</code></li>
<li>For Sawyer: <code>rosrun intera_interface enable_robot.py -r</code></li>
</ul></li>
</ol>
<h1 id="programming-the-robots">Programming the Robots</h1>
<p>Sawyer and Baxter are programmed using very similar interfaces; therefore, information for one robot often applies to the other. Especially relevant is that much of the Baxter ROS API documentation applies to sawyer as well.</p>
<ul>
<li><a href="https://sdk.rethinkrobotics.com/wiki/Home">Baxter SDK Wiki</a></li>
<li><a href="http://api.rethinkrobotics.com/baxter_interface/html/index.html">Baxter API Reference</a></li>
<li><a href="http://sdk.rethinkrobotics.com/wiki/API_Reference">Baxter ROS API Reference</a></li>
<li><a href="https://sdk.rethinkrobotics.com/intera/Main_Page">Sawyer SDK Wiki</a></li>
<li><a href="https://sdk.rethinkrobotics.com/intera/API_Reference">Sawyer ROS API Reference</a></li>
<li><a href="https://rethinkrobotics.github.io/intera_sdk_docs/5.1.0/intera_interface/html/index.html">Sawyer Python API</a></li>
<li><a href="https://sdk.rethinkrobotics.com/wiki/Advanced_Understanding">Baxter Advanced Understanding</a> (Not too advanced for you!)</li>
</ul>
<h2 id="urdf-for-baxter-and-sawyer">URDF for Baxter and Sawyer</h2>
<ul>
<li>Each robot has an internal URDF, with parameters that have been factory calibrated to account for manufacturing tolerances.
<ul>
<li>This URDF is stored in <code>/robot_description</code> in the parameter server.</li>
</ul></li>
<li>Generic URDFs are available:
<ul>
<li>For Baxter: <code>baxter_description</code> package (from the <code>baxter_common</code> git repo)</li>
<li>For Sawyer: <code>sawyer_robot_package</code></li>
</ul></li>
<li>Two <code>robot_state_publishers</code> are used to publish the commanded and the real pose of the robot
<ul>
<li>See <a href="https://sdk.rethinkrobotics.com/wiki/URDF">https://sdk.rethinkrobotics.com/wiki/URDF</a> (Applies to Baxter and Sawyer)</li>
<li>The robots actually run a <a href="https://github.com/RethinkRobotics/mutable_robot_state_publisher">Mutable Robot State Publisher</a>
<ul>
<li>When grippers are added, the URDF changes</li>
<li>The Mutable Robot State publisher subscribes to <code>/robot/urdf</code> and can have pieces of the URDF modified in real time.</li>
</ul></li>
</ul></li>
<li>When using grippers, you should update the URDF to properly account for the gripper. We use electric grippers.
<ul>
<li>For Baxter: <code>rethink_ee_description</code> package in the <code>baxter_common</code> repository has URDF files for each gripper.</li>
<li>For Sawyer: <code>intera_common</code> contains the <code>intera_tools_description</code> package.</li>
<li>An example that adds a gripper to the baxter urdf can be found <a href="https://github.com/NxRLab/nxr_baxter/commit/452a2aa7ef0e3c984936e5436f883e9dee275563">here</a>.
<ul>
<li>This example is used on the Willen's Wing Baxter</li>
<li>The launch file calls a bash script which uses Rethink's <code>send_urdf_fragment.py</code> to update the urdf.</li>
<li>The gripper xacro file was adjusted to exactly match our gripper (see <a href="https://github.com/NxR-Baxter/baxter_common/commit/c70a194127d09fa21e2d726c171ff2c02c3baa4b">this commit</a>)</li>
</ul></li>
<li>When using MoveIt, you need to make sure your grippers are setup properly</li>
</ul></li>
</ul>
<h1 id="simulators">Simulators</h1>
<ul>
<li><p><a href="https://sdk.rethinkrobotics.com/wiki/Baxter_Simulator">Baxter Gazebo</a></p>
<ul>
<li>Note: you do not need to actually run baxter.sh to use the simulator.</li>
<li>baxter.sh is an example of the Rethink Setup script that I do not use because I set my ROS environment variables manually</li>
</ul></li>
<li><p><a href="https://sdk.rethinkrobotics.com/intera/Gazebo_Tutorial">Sawyer Gazebo Tutorial</a></p></li>
<li><p>The simulated robots use the same API's as the real robots. However, your <code>ROS_MASTER_URI</code> should be <code>http://localhost:11311</code> and <code>ROS_IP</code> unset for you to use the simulator.</p></li>
</ul>
<h1 id="series-elastic-actuators">Series Elastic Actuators</h1>
<p>The Baxter and Sawyer robots use Series Elastic Actuators (SEAs) at each joint. In a series elastic actuator, the motor drives a gearbox which is then connected to the joint via a spring (rather than via a stiff rigid link, as in a traditional actuator). This design sacrifices bandwidth in exchange for robustness and more precise force control.</p>
<p>For example, rather than requiring a precise motor/gearbox model to estimate joint torque from motor current estimates, with a series elastic actuator joint torque can determined by measuring the displacement of the elastic element. Additionally, controlling joint torque can be accomplished by controlling position (i.e, the displacement of the elastic element).</p>
<h2 id="thought-experiments">Thought Experiments</h2>
<h3 id="regular-actuator">Regular Actuator</h3>
<p>Imagine you are holding a solid steel rod. The rod is stiff. As you move the rod around, its tip remains fixed relative to where your hand is; it does not bounce around. The tip remains steady even if you move your hand really fast. Thus, you have high bandwidth and high precision control of the rod tip.</p>
<p>Now imagine that you want drag the rod along the wall. You move the rod against the wall. However, what if your position measurement is slightly imprecise? You think the rod tip is 0.001 inches away from the wall when it is actually touching. Your controller will continue to try to move that extra 0.001 inches, pushing into the wall. To accomplish this task the stiff rod (or the wall) will need to deform by 0.001 inches; however, because they are stiff this deformation requires a lot of force, which you will feel in your hand. Thus, a small error in position can cause a large force on the motor (your hand).</p>
<h3 id="series-elastic-actuator">Series Elastic Actuator</h3>
<p>Now imagine that the tip of the rod is connected to your hand via a spring. As you move your hand around, the tip will bounce around on the spring, unless you move really slowly. Thus you experience lower positional bandwidth and precision for the location of the rod tip.</p>
<p>However, when you go to move the rod against the wall, as soon as you make contact the spring will start to compress. Thus, even if your position controller thinks the tip is 0.001 inches away from the wall when it is actually touching, it can move the extra 0.001 inch easily: the spring will simply compress an amount according to its stiffness (assumed to be significantly less than the stiff rod). Furthermore, measuring the spring's displacement will tell use the applied force.</p>
</div>
<div class="footer">
Author: Matthew Elwin.
</div>
</div>
</div>

</body>
</html>
